>LIST
20     CLEAR R: CLEAR C: CLEAR D: CLEAR O: CLEAR B
100    REM FIRST TIME SETUP
110    LET DIR=0
200    REM MAIN LOOP
210    XIL 510 : ROS 000
220    XIH 510 : OST 000 : GOSUB 10000 : REM POLL EVERY 1/2 SEC
230    IF DIR=0 THEN GOSUB 2000 
240    IF DIR=1 THEN GOSUB 3000
250    IF DIR=2 THEN GOSUB 4000
260    LIO
999    REM END MAIN LOOP
1000   GOTO 200
2000   REM MOTOR OFF
2010   OTU 000: OTU 001: OTU 002: OTU 003 
2030   RETURN 
3000   REM MOTOR CLOCKWISE
3010   OTU 000: OTU 001: OTL 002: OTL 003 
3030   RETURN 
4000   REM MOTOR COUNTER CLOCKWISE
4010   OTL 000: OTL 001: OTU 002: OTU 003 
4030   RETURN 
5000   REM CHANGE DIRECTION
5010   IF DIR=0 THEN DIR=IS_ODD+1 : RETURN
5020   IF DIR=1 THEN DIR=2 : RETURN
5030   IF DIR=2 THEN DIR=1 : RETURN
5040   DIR=0 : RETURN
10000  REM TICK INTERRUPT START
10020  ROLL=INT(100*ABS(RND))
10040  IS_ODD=ROLL.AND.1
10050  PRINT ROLL,IS_ODD,DIR
10060  IF ROLL<70 THEN RETURN : REM LEAN TOWARDS CURRENT DIRECTION
10070  IF ROLL>=70 .AND. ROLL<80 THEN DIR=0 : REM RANDOMLY STOP
10080  IF ROLL>=80 THEN GOSUB 5000
10100  RETURN

READY
